# Тесты для Group Changer Bot

## Запуск тестов

```bash
# Установка зависимостей для тестирования
pip install -r requirements.txt

# Запуск всех тестов
pytest

# Запуск с подробным выводом
pytest -v

# Запуск конкретного файла тестов
pytest tests/test_database.py

# Запуск конкретного теста
pytest tests/test_database.py::test_create_user

# Запуск с покрытием кода
pytest --cov=. --cov-report=html
```

## Структура тестов

- `test_database.py` - тесты для работы с базой данных
- `test_matcher.py` - тесты для логики поиска мэтчей
- `test_keyboards.py` - тесты для клавиатур

## Что покрыто тестами

### database.py
- ✅ Инициализация базы данных
- ✅ Создание пользователя
- ✅ Проверка существования пользователя
- ✅ Установка желаемых групп
- ✅ Обновление желаемых групп
- ✅ Обновление текущей группы
- ✅ Получение пользователей из группы
- ✅ Удаление пользователя (CASCADE)

### utils/matcher.py
- ✅ Поиск мэтчей для несуществующего пользователя
- ✅ Поиск мэтчей без желаемых групп
- ✅ Простой мэтч (два пользователя)
- ✅ Несколько мэтчей
- ✅ Отсутствие мэтчей
- ✅ Исключение самого пользователя из мэтчей
- ✅ Отправка уведомлений о мэтчах

### keyboards/keyboards.py
- ✅ Форматирование кнопок групп
- ✅ Форматирование текста групп
- ✅ Форматирование списков групп
- ✅ Получение расписания
- ✅ Создание клавиатур

## Примечания

- Тесты используют отдельную тестовую базу данных (`test_bot_database.db`)
- База данных создаётся и удаляется для каждого теста
- Все тесты асинхронные благодаря `pytest-asyncio`

